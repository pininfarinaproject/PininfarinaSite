function ad(e,a){return e.setDate(e.getDate()+a)}function gd(e,a,t){var d=1e3,i=60*d,n=60*i,r=24*n,l=7*r;e=new Date(e).getTime(),a="now"==a?(new Date).getTime():new Date(a).getTime();var s=a-e;if(isNaN(s))return 0/0;switch(t){case"years":return a.getFullYear()-e.getFullYear();case"months":return 12*a.getFullYear()+a.getMonth()-(12*e.getFullYear()+e.getMonth());case"weeks":return Math.floor(s/l);case"days":return Math.floor(s/r);case"hours":return Math.floor(s/n);case"minutes":return Math.floor(s/i);case"seconds":return Math.floor(s/d);default:return void 0}}function nd(date){var m=date.getMonth(),d=date.getDate(),y=date.getFullYear(),currentdt=m+"-"+d+"-"+y,dt=new Date,today=dt.getMonth()+"-"+dt.getDate()+"-"+dt.getFullYear(),holidayDates=eval("["+jQuery("#booking_holidays").val()+"]"),globalHolidays=eval("["+jQuery("#booking_global_holidays").val()+"]");for(iii=0;iii<globalHolidays.length;iii++)if(-1!=jQuery.inArray(d+"-"+(m+1)+"-"+y,globalHolidays))return[!1,"","Holiday"];for(ii=0;ii<holidayDates.length;ii++)if(-1!=jQuery.inArray(d+"-"+(m+1)+"-"+y,holidayDates))return[!1,"","Holiday"];return[!0]}function sp(date){var m=date.getMonth(),d=date.getDate(),y=date.getFullYear(),currentdt=m+"-"+d+"-"+y,dt=new Date,today=dt.getMonth()+"-"+dt.getDate()+"-"+dt.getFullYear(),deliveryDates=eval("["+jQuery("#wapbk_booking_dates").val()+"]");for(ii=0;ii<deliveryDates.length;ii++)if(-1!=jQuery.inArray(d+"-"+(m+1)+"-"+y,deliveryDates))return[!0];return[!1]}function avd(date){var delay_days=parseInt(jQuery("#wapbk_minimumOrderDays").val()),noOfDaysToFind=parseInt(jQuery("#wapbk_number_of_dates").val()),recurring_days=jQuery("#wapbk_recurringDays").val(),specific_dates=jQuery("#wapbk_specificDates").val();isNaN(delay_days)&&(delay_days=0),isNaN(noOfDaysToFind)&&(noOfDaysToFind=30);var minDate=delay_days,date=new Date,t_year=date.getFullYear(),t_month=date.getMonth()+1,t_day=date.getDate(),t_month_days=new Date(t_year,t_month,0).getDate(),s_day=new Date(ad(date,delay_days));start=s_day.getMonth()+1+"/"+s_day.getDate()+"/"+s_day.getFullYear();var start_month=s_day.getMonth()+1,end_date=new Date(ad(s_day,noOfDaysToFind));end=end_date.getMonth()+1+"/"+end_date.getDate()+"/"+end_date.getFullYear();var specific_max_date=start,m=date.getMonth(),d=date.getDate(),y=date.getFullYear(),currentdt=m+"-"+d+"-"+y,dt=new Date,today=dt.getMonth()+"-"+dt.getDate()+"-"+dt.getFullYear(),deliveryDates=eval("["+jQuery("#wapbk_booking_dates").val()+"]");for(ii=0;ii<deliveryDates.length;ii++){var split=deliveryDates[ii].split("-"),specific_date=split[1]+"/"+split[0]+"/"+split[2],diff=gd(specific_max_date,specific_date,"days");diff>=0&&(specific_max_date=specific_date)}for(var loopCounter=gd(start,end,"days"),prev=s_day,new_l_end,is_holiday,i=1;loopCounter>=i;i++){var l_start=new Date(start),l_end=new Date(end);new_l_end=l_end;var new_date=new Date(ad(l_start,i)),day="";""==jQuery("#wapbk_multiple_day_booking").val()?(day="booking_weekday_"+new_date.getDay(),day_check=jQuery("#wapbk_"+day).val(),is_specific=sp(new_date)):(is_specific="true",day_check="on"),is_holiday=nd(new_date),("false"==is_specific||"true"!=is_holiday)&&("on"!=day_check||"true"!=is_holiday)&&(new_l_end=l_end=new Date(ad(l_end,1)),end=l_end.getMonth()+1+"/"+l_end.getDate()+"/"+l_end.getFullYear(),"on"!=recurring_days&&"on"==specific_dates?(diff=gd(l_end,specific_max_date,"days"),diff>=0&&(loopCounter=gd(start,end,"days"))):loopCounter=gd(start,end,"days"))}return{minDate:minDate,maxDate:l_end}}